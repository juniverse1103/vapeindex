---
import Layout from '../layouts/Layout.astro';
import Header from '../components/Header.astro';

// Sample data (will be replaced with real data from D1)
const featuredProducts = [
  { id: '1', name: 'Elf Bar BC5000 - Watermelon Ice', type: 'disposable', brand: 'Elf Bar', rating: 4.8, reviews: 1247 },
  { id: '2', name: 'Caliburn G2 Pod System', type: 'pod', brand: 'Uwell', rating: 4.7, reviews: 892 },
  { id: '3', name: 'Pax 3 - Dry Herb Vaporizer', type: 'dry_herb', brand: 'Pax', rating: 4.9, reviews: 2156 },
];

const topPosts = [
  { id: '1', title: 'Best disposable vapes of 2025?', score: 142, comments: 68, author: 'vapeenthusiast' },
  { id: '2', title: 'PSA: Fake Elf Bars - How to spot them', score: 287, comments: 94, author: 'authentic_only' },
  { id: '3', title: 'Pax 3 vs Mighty+ - Full comparison', score: 164, comments: 121, author: 'herb_connoisseur' },
];
---

<Layout>
  <Header />

  <main style="max-width: 1200px; margin: 0 auto; padding: 1em;">
    <!-- Hero Section -->
    <div style="background: white; padding: 2em; margin-bottom: 1em; border: 1px solid var(--border);">
      <h1 style="font-size: 18pt; margin: 0 0 0.5em 0;">Welcome to VapeIndex</h1>
      <p style="font-size: 11pt; line-height: 1.6; margin: 0 0 1em 0; color: var(--text-muted);">
        The complete vaping index. Price tracking, reviews, and community discussions for all vapes‚Äînicotine, THC, dry herb, and CBD.
        Compare products, find deals, and join the conversation.
      </p>
      <p style="margin: 0;">
        <a href="/login" style="background: var(--brand); color: white; padding: 0.6em 1.2em; border-radius: 3px; display: inline-block; font-weight: bold;">
          Join the Community
        </a>
        <span style="margin: 0 0.5em; color: var(--text-muted);">or</span>
        <a href="/products" style="color: var(--brand); font-weight: bold;">Browse Products ‚Üí</a>
      </p>
    </div>

    <!-- Two Column Layout -->
    <div style="display: grid; grid-template-columns: 2fr 1fr; gap: 1em;">
      <!-- Main Content - Top Posts -->
      <div>
        <h2 style="font-size: 12pt; margin: 0 0 0.5em 0;">Top Discussions</h2>
        <table style="width: 100%; background: white; border: 1px solid var(--border); border-collapse: collapse;">
          {topPosts.map((post, i) => (
            <tr style="border-bottom: 1px solid var(--border);">
              <td style="padding: 0.5em; width: 2em; text-align: center; color: var(--text-muted);">
                {i + 1}.
              </td>
              <td style="padding: 0.5em;">
                <div>
                  <a href={`/post/${post.id}`} style="font-weight: 500;">
                    {post.title}
                  </a>
                </div>
                <div class="text-muted" style="margin-top: 0.25em;">
                  {post.score} points |
                  by {post.author} |
                  <a href={`/post/${post.id}`}>{post.comments} comments</a>
                </div>
              </td>
            </tr>
          ))}
        </table>

        <p style="margin-top: 1em;">
          <a href="/posts" style="color: var(--brand);">View all discussions ‚Üí</a>
        </p>
      </div>

      <!-- Sidebar - Featured Products -->
      <div>
        <h2 style="font-size: 12pt; margin: 0 0 0.5em 0;">Top Rated Products</h2>
        <div style="background: white; border: 1px solid var(--border); padding: 1em;">
          {featuredProducts.map((product) => (
            <div style="margin-bottom: 1em; padding-bottom: 1em; border-bottom: 1px solid var(--border); last-child:border-bottom: none;">
              <div style="font-weight: 500; margin-bottom: 0.25em;">
                <a href={`/product/${product.id}`}>{product.name}</a>
              </div>
              <div class="text-muted">
                <span style="color: var(--brand);">‚òÖ {product.rating}</span> ¬∑
                {product.reviews} reviews ¬∑
                {product.type}
              </div>
            </div>
          ))}

          <a href="/products" style="color: var(--brand); font-size: 9pt;">View all products ‚Üí</a>
        </div>

        <!-- Quick Stats -->
        <div style="background: white; border: 1px solid var(--border); padding: 1em; margin-top: 1em;">
          <h3 style="font-size: 10pt; margin: 0 0 0.5em 0;">Community Stats</h3>
          <div class="text-muted" style="font-size: 9pt;">
            <div>üî• 2,847 reviews this month</div>
            <div>üí¨ 8,234 comments this week</div>
            <div>üì¶ 1,200+ products tracked</div>
            <div>üåê Global vaping community</div>
          </div>
        </div>

        <!-- CTA -->
        <div style="background: linear-gradient(135deg, #ff6600 0%, #ff5500 100%); color: white; padding: 1em; margin-top: 1em; border-radius: 3px;">
          <h3 style="margin: 0 0 0.5em 0; font-size: 11pt;">Join the Community</h3>
          <p style="margin: 0 0 0.5em 0; font-size: 9pt; opacity: 0.9;">
            Track prices, review products, share knowledge. Join vapers worldwide.
          </p>
          <a href="/login" style="background: white; color: var(--brand); padding: 0.5em 1em; border-radius: 3px; display: inline-block; font-weight: bold; font-size: 9pt;">
            Sign Up Free
          </a>
        </div>
      </div>
    </div>

    <!-- Footer -->
    <footer style="margin-top: 2em; padding-top: 1em; border-top: 1px solid var(--border); text-align: center; color: var(--text-muted); font-size: 8pt;">
      <p>
        <a href="/about">About</a> |
        <a href="/guidelines">Guidelines</a> |
        <a href="/faq">FAQ</a> |
        <a href="https://discord.gg/vapeindex" target="_blank">Discord</a> |
        <a href="https://github.com/juniverse1103/vapeindex" target="_blank">GitHub</a>
      </p>
      <p style="margin-top: 0.5em;">Built with Astro + Hono + Cloudflare. Open source.</p>
    </footer>
  </main>
</Layout>
