name = "vapeindex-backend"
main = "src/index.ts"
compatibility_date = "2024-11-19"

[dev]
port = 51728

# Default local development database (in-memory, ephemeral)
[[d1_databases]]
binding = "DB"
database_name = "vapeindex-db"
database_id = "local"

# KV namespace for sessions (local dev uses in-memory preview)
[[kv_namespaces]]
binding = "SESSIONS"
id = "preview_id"
preview_id = "preview_id"

# R2 bucket for images (local dev uses preview)
[[r2_buckets]]
binding = "IMAGES"
bucket_name = "vapeindex-images"
preview_bucket_name = "vapeindex-images"

# Development Environment (remote dev database)
[env.dev]
name = "vapeindex-backend-dev"
[[env.dev.d1_databases]]
binding = "DB"
database_name = "vapeindex-db-dev"
database_id = "" # Will be filled after creating dev database

# Production Environment
[env.production]
name = "vapeindex-backend-prod"
[[env.production.d1_databases]]
binding = "DB"
database_name = "vapeindex-db-production"
database_id = "64e77794-8b09-48cd-b1a7-1cf83286c8d4"

[[env.production.kv_namespaces]]
binding = "SESSIONS"
id = "45da4751cdf5441e85dd8d76c58b1ed5"

[[env.production.r2_buckets]]
binding = "IMAGES"
bucket_name = "vapeindex-images"
